# 第七周总结
## 设备文件
### I/O Ports: I/O设备地址
### 一切皆文件：open(), read(), write(), close()
### 设备类型：
1. 块设备：block，存取单位“块”，磁盘
2. 字符设备：char，存取单位“字符”，键盘
### 设备文件：关联至一个设备驱动程序，进而能够跟与之对应硬件设备进行通信
### 设备号码：
1. 主设备号：major number, 标识设备类型
2. 次设备号：minor number, 标识同一类型下的不同设备
## 硬盘接口类型
### 并行：
1. IDE：133MB
2. SCSI：640MB/s
### 串口：
1. SATA：6Gbps
2. SAS：6Gbps
3. USB：480MB
### rpm: 
1.  rotations
2. per minute
## 机械硬盘和固态硬盘
1. 机械硬盘（HDD）：Hard Disk Drive，即是传统普通硬盘，主要由：盘片，磁头，盘
片转轴及控制电机，磁头控制器，数据转换器，接口，缓存等几个部分组成。机械硬盘
中所有的盘片都装在一个旋转轴上，每张盘片之间是平行的，在每个盘片的存储面上有
一个磁头，磁头与盘片之间的距离比头发丝的直径还小，所有的磁头联在一个磁头控制
器上，由磁头控制器负责各个磁头的运动。磁头可沿盘片的半径方向运动，加上盘片每
分钟几千转的高速旋转，磁头就可以定位在盘片的指定位置上进行数据的读写操作。数
据通过磁头由电磁流来改变极性方式被电磁流写到磁盘上，也可以通过相反方式读取。
硬盘为精密设备，进入硬盘的空气必须过滤
2. 固态硬盘（SSD）：Solid State Drive，用固态电子存储芯片阵列而制成的硬盘，由控
制单元和存储单元（FLASH芯片、DRAM芯片）组成。固态硬盘在接口的规范和定义、
功能及使用方法上与普通硬盘的完全相同，在产品外形和尺寸上也与普通硬盘一致
3. 相较于HDD，SSD在防震抗摔、传输速率、功耗、重量、噪音上有明显优势，SSD传
输速率性能是HDD的2倍
4. 相较于SSD，HDD在价格、容量、使用寿命上占有绝对优势
5. 硬盘有价，数据无价，目前SSD不能完全取代HHD
## CHS和LBA
### CHS
1. 采用24bit位寻址
2. 其中前10位表示cylinder，中间8位表示head，后面6位表示sector
3. 最大寻址空间8GB
### LBA（logical block addressing）
1. LBA是一个整数，通过转换成CHS格式完成磁盘具体寻址
2. ATA-1规范中定义了28位寻址模式，以每扇区512位组来计算，ATA-1所定
义的28位LBA上限达到128 GiB。2002年ATA-6规范采用48位LBA，同样以
每扇区512位组计算容量上限可达128 Petabytes
3. 由于CHS寻址方式的寻址空间在大概8GB以内，所以在磁盘容量小于大概8GB
时，可以使用CHS寻址方式或是LBA寻址方式；在磁盘容量大于大概8GB时，则
只能使用LBA寻址方式
## 磁盘分区
### 为什么分区
1. 优化I/O性能
2. 实现磁盘空间配额限制
3. 提高修复速度
4. 隔离系统和程序
5. 安装多个OS
6. 采用不同文件系统
## 分区
### 两种分区方式：MBR，GPT
### MBR: Master Boot Record，1982年，使用32位表示扇区数，分区不超过2T
### 如何分区：按柱面
### 0磁道0扇区：
1. 512bytes
2. 446bytes: boot loader
3. 64bytes：分区表，其中每16bytes标识一个分区
4. 2bytes: 55AA
### 4个主分区；3主分区+1扩展(N个逻辑分区)
## MBR分区结构
### 硬盘主引导记录MBR由4个部分组成
### 主引导程序（偏移地址0000H--0088H），它负责从活动分区中装载，并运行
系统引导程序
### 出错信息数据区，偏移地址0089H--00E1H为出错信息，00E2H--01BDH全为
0字节
### 分区表（DPT,Disk Partition Table）含4个分区项，偏移地址01BEH--01FDH,
每个分区表项长16个字节，共64字节为分区项1、分区项2、分区项3、分区项4
### 结束标志字，偏移地址01FE--01FF的2个字节值为结束标志55AA
## GPT分区
### 1.GPT:GUID（Globals Unique Identifiers） partition table 支持128个分区，使用64位，支持8Z（ 512Byte/block ）64Z （ 4096Byte/block）
### 2. 使用128位UUID(Universally Unique Identifier) 表示磁盘和分区 GPT分区表自动备份在头和尾两份，并有CRC校验位
### 3. UEFI (统一扩展固件接口)硬件支持GPT，使操作系统启动
## 管理分区
### 列出块设备
1. lsblk
### 创建分区使用：
1. fdisk 创建MBR分区
2. gdisk 创建GPT分区
3. parted 高级分区操作
### 重新设置内存中的内核分区表版本
1. partprobe
## parted命令
### parted的操作都是实时生效的，小心使用
### 用法：parted [选项]... [设备 [命令 [参数]...]...]
1. parted /dev/sdb mklabel gpt|msdos
2. parted /dev/sdb print
3. parted /dev/sdb mkpart primary 1 200 （默认M）
4. parted /dev/sdb rm 1
5. parted –l 列出分区
## 分区工具fdisk和gdisk
### gdisk /dev/sdb 类fdisk 的GPT分区
### fdisk -l [-u] [device...] 查看
### fdisk /dev/sdb 管理
### 子命令：
1. p 分区列表
2. t 更改分区类型
3. n 创建新分区
4. d 删除分区
5. v 校验分区
6. u 转换单位
7. w 保存并退出
8. q 不保存并退出
